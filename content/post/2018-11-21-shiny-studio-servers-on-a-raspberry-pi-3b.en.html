---
title: Setting up your own Shiny and RStudio Server on a Raspberry Pi 3B+
description: This article shows you how to install Shiny and RStudio Server on a Raspberry Pi 3B+ along with the most common companion tools to have a fully functional server to not only host but also develop your own Shiny apps.
author: andres-castro
date: '2018-11-21'
slug: shiny_rstudio_server
categories:
  - R
  - raspberry
series: 
  - r-admin
tags:
  - shiny-server
  - rstudio-server
  - server
  - shiny
  - rstudio
  - admin
  - raspberry-pi
  - postgresql
  - nginx
draft: false
images: ["shiny_rstudio_server.jpg"]
authors: ["andres-castro"]
output:
  blogdown::html_page:
    toc: true
    highlight: zenburn
---

<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#preparing-the-raspberry-pi">Preparing The Raspberry Pi</a></li>
<li><a href="#setting-up-the-server">Setting Up The Server</a></li>
<li><a href="#installing-shiny-server">Installing Shiny Server</a></li>
<li><a href="#installing-rstudio-server">Installing Rstudio Server</a></li>
<li><a href="#extra-steps">Extra Steps</a></li>
<li><a href="#final-comments">Final Comments</a></li>
</ul>
</div>

<p>I have recently participated in a topic at <a href="https://community.rstudio.com/t/raspberry-pi-as-a-viable-shiny-server/18672?u=andresrcs">RStudio Community</a> where <a href="https://twitter.com/jladata">@jladata</a> was asking if a Raspberry Pi 3B+ could make it as a viable Shiny server, I currently use a Raspberry Pi for that purpose and It was pointed out to me that this might be an interesting topic for some people, so I´m going to share with you my experience setting up Shiny and Rstudio Server on a Raspberry Pi 3B+. :thumbsup:</p>
<p>I’m installing all the software directly in the OS (Raspbian), I’m aware that there are other options such as Docker containers, but this is the method I prefer.</p>
<p>Also, the steps that I’m going to share with you, are applicable for this specific setup:</p>
<p><strong>“Raspberry Pi 3B+ running Raspbian Stretch Lite (not tested yet on the new Raspbian Buster)”</strong></p>
<blockquote>
<p>:pencil2: Have in mind that this guide might not be directly applicable for other SBCs, Linux distributions or even other versions of Raspberry Pi SBCs.</p>
</blockquote>
<div id="preparing-the-raspberry-pi" class="section level2">
<h2>Preparing The Raspberry Pi</h2>
<p>First, we need to start by loading a fresh image of Raspbian Stretch Lite onto our SD card (I recommend at least 32GB class 10), you can download it from the official <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian site</a>.</p>
<p>Although not mandatory, I recommend performing the following actions using the <code>sudo raspi-config</code> application:</p>
<ul>
<li>Expand Filesystem (Advanced Options / Expand Filesystem).</li>
<li>Reduce GPU memory to 16MB (Advanced Options / Memory Split).</li>
<li>Disable “Predictable network interfaces” (Network Options / Network interface names).</li>
</ul>
<p>I also recommend using a wired internet connection and disabling the onboard wifi/Bluetooth module. You can disable it persistently by editing this file: <code>sudo nano /boot/config.txt</code>, by adding these two lines:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="va">dtoverlay=</span>pi3-disable-bt</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="va">dtoverlay=</span>pi3-disable-wifi</span></code></pre></div>
<p>Next, we need to set a static IP for our Raspberry Pi, edit this file: <code>sudo nano /etc/dhcpcd.conf</code>, accordingly with your own needs. This is a sample IP configuration:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Sample static IP configuration:</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="ex">interface</span> eth0</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="ex">static</span> ip_address=192.168.1.101/24</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#static ip6_address=fd51:42f8:caae:d92e::ff/64</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="ex">static</span> routers=192.168.1.1</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="ex">static</span> domain_name_servers=192.168.1.1 8.8.8.8 fd51:42f8:caae:d92e::1</span></code></pre></div>
<p>Enable all the repositories by uncommenting all lines in this file: <code>sudo nano /etc/apt/sources.list</code> and then perform the mandatory updates with this command <code>sudo apt update &amp;&amp; sudo apt full-upgrade</code>.</p>
<p>You have to add at least 1GB of swap memory for this installation but you are going to need more, later for installing/compiling some R libraries, so with 3GB would be fine, you can do it with these commands:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">sudo</span> /bin/dd if=/dev/zero of=/var/swap.1 bs=1M count=3072</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">sudo</span> /sbin/mkswap /var/swap.1</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">sudo</span> /sbin/swapon /var/swap.1</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">sudo</span> sh -c <span class="st">&#39;echo &quot;/var/swap.1 swap swap defaults 0 0 &quot; &gt;&gt; /etc/fstab&#39;</span></span></code></pre></div>
<p>Prevent the unnecessary use of swap memory for protecting your SD card:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">sudo</span> nano /etc/sysctl.conf</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Add this at the end</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="ex">vm.swappiness</span>=10</span></code></pre></div>
</div>
<div id="setting-up-the-server" class="section level2">
<h2>Setting Up The Server</h2>
<p>For convenience, we need an HTML server and Nginx is a really good option because of its reduced requirements. You can install Nginx with these commands:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">sudo</span> apt install nginx</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">sudo</span> chown -R www-data:pi /var/www/html/</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">sudo</span> chmod -R 770 /var/www/html/</span></code></pre></div>
<p>Then, we need a SQL server for storing and manipulating our data, I personally prefer PostgreSQL since it’s open-source and has impressive capabilities, but it´s up to you which one to choose. You can install PostgreSQL with this command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">sudo</span> apt install postgresql libpq-dev postgresql-client postgresql-client-common</span></code></pre></div>
<p>Configure PostgreSQL to accept local and remote connections by editing these files and modify/add/comment these lines:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">sudo</span> nano /etc/postgresql/9.6/main/pg_hba.conf <span class="co"># Edit as it follows</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="bu">local</span> <span class="va">all</span> <span class="va">all</span> <span class="va">md5</span> <span class="co">#Modify </span></span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="ex">host</span> all all 192.168.1.0/24 trust <span class="co">#Add</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="ex">host</span> all all 0.0.0.0/0 password <span class="co">#Add</span></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="fu">sudo</span> nano /etc/postgresql/9.6/main/postgresql.conf <span class="co"># Edit as it follows</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="co">#listen_addresses #Comment </span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="va">listen_addresses=</span><span class="st">&#39;*&#39;</span> <span class="co">#Add </span></span></code></pre></div>
<p>Restart PostgreSQL service:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">sudo</span> systemctl restart postgresql</span></code></pre></div>
<p>Create the pi user and database in the PostgreSQL server:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">sudo</span> su postgres</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ex">createuser</span> pi -P --interactive</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="ex">psql</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="ex">create</span> database pi<span class="kw">;</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>\<span class="ex">q</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="bu">exit</span></span></code></pre></div>
<p>Now, we get to the R specific part of the process, we are going to install the latest version of R from source with these commands:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">sudo</span> apt-get install -y gfortran libreadline6-dev libx11-dev libxt-dev \</span>
<span id="cb10-2"><a href="#cb10-2"></a>                               libpng-dev libjpeg-dev libcairo2-dev xvfb \</span>
<span id="cb10-3"><a href="#cb10-3"></a>                               libbz2-dev libzstd-dev liblzma-dev \</span>
<span id="cb10-4"><a href="#cb10-4"></a>                               libcurl4-openssl-dev \</span>
<span id="cb10-5"><a href="#cb10-5"></a>                               texinfo texlive texlive-fonts-extra \</span>
<span id="cb10-6"><a href="#cb10-6"></a>                               screen wget libpcre2-dev</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="bu">cd</span> /usr/local/src</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="fu">sudo</span> wget https://cran.rstudio.com/src/base/R-4/R-4.0.0.tar.gz</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="fu">sudo</span> su</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="fu">tar</span> zxvf R-4.0.0.tar.gz</span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="bu">cd</span> R-4.0.0</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="ex">./configure</span> --enable-R-shlib <span class="co">#--with-blas --with-lapack #optional</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="fu">make</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="fu">make</span> install</span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="bu">cd</span> ..</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="fu">rm</span> -rf R-4.0.0*</span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="bu">exit</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="bu">cd</span></span></code></pre></div>
<p>:heavy_exclamation_mark:<strong><em>WARNING: EVERYTHING BEYOND THIS POINT IS EXTREMELY TIME-CONSUMING</em></strong>
<strong>e.g. Installing RStudio from source on Raspbian can take around 27 hours :open_mouth:</strong></p>
</div>
<div id="installing-shiny-server" class="section level2">
<h2>Installing Shiny Server</h2>
<p>We are going to install Shiny Server from source, but first, we have to install its dependencies.</p>
<blockquote>
<p>:pencil2: It’s necessary to install R packages as superuser, for Shiny to be able to use them.</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;later&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;fs&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;Rcpp&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;httpuv&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;mime&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;jsonlite&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;digest&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;htmltools&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;xtable&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;R6&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;Cairo&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;sourcetools&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="fu">sudo</span> su - -c <span class="st">&quot;R -e </span><span class="dt">\&quot;</span><span class="st">install.packages(&#39;shiny&#39;, repos=&#39;http://cran.rstudio.com/&#39;)</span><span class="dt">\&quot;</span><span class="st">&quot;</span></span></code></pre></div>
<p>Install cmake from source:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">wget</span> https://cmake.org/files/v3.17/cmake-3.17.0.tar.gz <span class="co"># Check for the latest version at  https://cmake.org/files/</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">tar</span> xzf cmake-3.17.0.tar.gz</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="bu">cd</span> cmake-3.17.0</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="ex">./configure</span>; <span class="fu">make</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="fu">sudo</span> make install</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="bu">cd</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="fu">rm</span> cmake-3.17.0.tar.gz</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="fu">rm</span> -rf cmake-3.17.0</span></code></pre></div>
<p>Now we can install Shiny Server with these commands:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">git</span> clone https://github.com/rstudio/shiny-server.git</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="bu">cd</span> shiny-server</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="va">DIR=</span><span class="kw">`</span><span class="bu">pwd</span><span class="kw">`</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="va">PATH=$DIR</span>/bin:<span class="va">$PATH</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="fu">mkdir</span> tmp</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="bu">cd</span> tmp</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="va">PYTHON=</span><span class="kw">`</span><span class="fu">which</span> python<span class="kw">`</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="fu">sudo</span> cmake -DCMAKE_INSTALL_PREFIX=/usr/local -DPYTHON=<span class="st">&quot;</span><span class="va">$PYTHON</span><span class="st">&quot;</span> ../</span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="fu">sudo</span> make</span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="fu">mkdir</span> ../build</span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="fu">sed</span> -i <span class="st">&#39;8s/.*/NODE_SHA256=a865e69914c568fcb28be7a1bf970236725a06a8fc66530799300181d2584a49/&#39;</span> ../external/node/install-node.sh <span class="co"># node-v12.15.0-linux-armv7l.tar.xz</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="fu">sed</span> -i <span class="st">&#39;s/linux-x64.tar.xz/linux-armv7l.tar.xz/&#39;</span> ../external/node/install-node.sh</span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="fu">sed</span> -i <span class="st">&#39;s/https:\/\/github.com\/jcheng5\/node-centos6\/releases\/download\//https:\/\/nodejs.org\/dist\//&#39;</span> ../external/node/install-node.sh</span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="kw">(</span><span class="bu">cd</span> .. <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> ./external/node/install-node.sh<span class="kw">)</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="kw">(</span><span class="bu">cd</span> .. <span class="kw">&amp;&amp;</span> <span class="ex">./bin/npm</span> --python=<span class="st">&quot;</span><span class="va">${PYTHON}</span><span class="st">&quot;</span> install --no-optional<span class="kw">)</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="kw">(</span><span class="bu">cd</span> .. <span class="kw">&amp;&amp;</span> <span class="ex">./bin/npm</span> --python=<span class="st">&quot;</span><span class="va">${PYTHON}</span><span class="st">&quot;</span> rebuild<span class="kw">)</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="fu">sudo</span> make install</span></code></pre></div>
<p>After installing it, you have to configure Shiny Server with these commands:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a><span class="bu">cd</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">sudo</span> ln -s /usr/local/shiny-server/bin/shiny-server /usr/bin/shiny-server</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="fu">sudo</span> useradd -r -m shiny</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="fu">sudo</span> mkdir -p /var/log/shiny-server</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="fu">sudo</span> mkdir -p /srv/shiny-server</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="fu">sudo</span> mkdir -p /var/lib/shiny-server</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="fu">sudo</span> chown shiny /var/log/shiny-server</span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="fu">sudo</span> mkdir -p /etc/shiny-server</span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="bu">cd</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="fu">sudo</span> wget \</span>
<span id="cb14-11"><a href="#cb14-11"></a>https://raw.github.com/rstudio/shiny-server/master/config/upstart/shiny-server.conf \</span>
<span id="cb14-12"><a href="#cb14-12"></a>-O /etc/init/shiny-server.conf</span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="fu">sudo</span> chmod 777 -R /srv</span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co"># Configure shiny-server autostart </span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="fu">sudo</span> nano /lib/systemd/system/shiny-server.service <span class="co"># Paste the following</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="co">#!/usr/bin/env bash</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>    [<span class="ex">Unit</span>]</span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="va">Description=</span>ShinyServer</span>
<span id="cb14-19"><a href="#cb14-19"></a>    [<span class="ex">Service</span>]</span>
<span id="cb14-20"><a href="#cb14-20"></a>    <span class="va">Type=</span>simple</span>
<span id="cb14-21"><a href="#cb14-21"></a>    <span class="va">ExecStart=</span>/usr/bin/shiny-server</span>
<span id="cb14-22"><a href="#cb14-22"></a>    <span class="va">Restart=</span>always</span>
<span id="cb14-23"><a href="#cb14-23"></a>    <span class="co"># Environment=&quot;LANG=en_US.UTF-8&quot;</span></span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="va">ExecReload=</span>/bin/kill <span class="ex">-HUP</span> <span class="va">$MAINPID</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>    <span class="va">ExecStopPost=</span>/bin/sleep <span class="ex">5</span></span>
<span id="cb14-26"><a href="#cb14-26"></a>    <span class="va">RestartSec=</span>1</span>
<span id="cb14-27"><a href="#cb14-27"></a>    [<span class="ex">Install</span>]</span>
<span id="cb14-28"><a href="#cb14-28"></a>    <span class="va">WantedBy=</span>multi-user.target</span>
<span id="cb14-29"><a href="#cb14-29"></a></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="fu">sudo</span> chown shiny /lib/systemd/system/shiny-server.service</span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="fu">sudo</span> systemctl daemon-reload</span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="fu">sudo</span> systemctl enable shiny-server</span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="fu">sudo</span> systemctl start shiny-server</span>
<span id="cb14-34"><a href="#cb14-34"></a></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="co"># Setting up proper user permissions:</span></span>
<span id="cb14-36"><a href="#cb14-36"></a><span class="fu">sudo</span> groupadd shiny-apps</span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="fu">sudo</span> usermod -aG shiny-apps pi</span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="fu">sudo</span> usermod -aG shiny-apps shiny</span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="bu">cd</span> /srv/shiny-server</span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="fu">sudo</span> chown -R pi:shiny-apps .</span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="fu">sudo</span> chmod g+w .</span>
<span id="cb14-42"><a href="#cb14-42"></a><span class="fu">sudo</span> chmod g+s .</span></code></pre></div>
</div>
<div id="installing-rstudio-server" class="section level2">
<h2>Installing Rstudio Server</h2>
<p>We are going to install RStudio server from source, this is extremely time-consuming (around 27 hours last time I checked), so get your self something to do while the Raspberry Pi installs dependencies and compiles everything.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Install Rust and Cargo</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">sudo</span> curl https://sh.rustup.rs -sSf <span class="kw">|</span> <span class="fu">sh</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="bu">source</span> <span class="va">$HOME</span>/.cargo/env</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Install sentry-cli</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="fu">sudo</span> git clone https://github.com/getsentry/sentry-cli.git</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="fu">sudo</span> chown -R pi ~/sentry-cli</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="bu">cd</span> sentry-cli</span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="ex">cargo</span> build</span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="bu">cd</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="fu">sudo</span> rm -rf sentry-cli</span>
<span id="cb15-11"><a href="#cb15-11"></a></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co"># Clone RStudio repository</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="fu">sudo</span> git clone https://github.com/rstudio/rstudio.git</span>
<span id="cb15-14"><a href="#cb15-14"></a></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co"># Avoid installing crashpad</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="fu">sudo</span> nano /home/pi/rstudio/dependencies/common/install-common</span>
<span id="cb15-17"><a href="#cb15-17"></a>    <span class="co"># Comment these lines</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>        <span class="co"># ./install-crashpad</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>        <span class="co"># sudo ./install-crashpad</span></span>
<span id="cb15-20"><a href="#cb15-20"></a></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co"># Install system dependencies</span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="bu">cd</span> rstudio/dependencies/linux</span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="fu">sudo</span> su</span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="ex">./install-dependencies-stretch</span> --exclude-qt-sdk</span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="ex">apt-get</span> install -y openjdk-8-jdk</span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="ex">apt</span> autoremove</span>
<span id="cb15-27"><a href="#cb15-27"></a></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co"># Configure Java</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="ex">java</span> -Xms1800m</span>
<span id="cb15-30"><a href="#cb15-30"></a></span>
<span id="cb15-31"><a href="#cb15-31"></a><span class="co"># Install latest gwt compiler</span></span>
<span id="cb15-32"><a href="#cb15-32"></a><span class="bu">cd</span> /home/pi/rstudio</span>
<span id="cb15-33"><a href="#cb15-33"></a><span class="fu">wget</span> http://dl.google.com/closure-compiler/compiler-latest.zip</span>
<span id="cb15-34"><a href="#cb15-34"></a><span class="fu">unzip</span> compiler-latest.zip</span>
<span id="cb15-35"><a href="#cb15-35"></a><span class="fu">rm</span> COPYING README.md compiler-latest.zip</span>
<span id="cb15-36"><a href="#cb15-36"></a><span class="fu">mv</span> closure-compiler-v20*.jar /home/pi/rstudio/src/gwt/tools/compiler/compiler.jar</span>
<span id="cb15-37"><a href="#cb15-37"></a></span>
<span id="cb15-38"><a href="#cb15-38"></a><span class="co"># Compile and install RStudio</span></span>
<span id="cb15-39"><a href="#cb15-39"></a><span class="fu">mkdir</span> build</span>
<span id="cb15-40"><a href="#cb15-40"></a><span class="bu">cd</span> build</span>
<span id="cb15-41"><a href="#cb15-41"></a><span class="fu">cmake</span> .. -DRSTUDIO_TARGET=Server -DCMAKE_BUILD_TYPE=Release</span>
<span id="cb15-42"><a href="#cb15-42"></a><span class="fu">make</span> install</span>
<span id="cb15-43"><a href="#cb15-43"></a></span>
<span id="cb15-44"><a href="#cb15-44"></a><span class="co">#Configure Rstudio</span></span>
<span id="cb15-45"><a href="#cb15-45"></a><span class="bu">cd</span></span>
<span id="cb15-46"><a href="#cb15-46"></a><span class="ex">useradd</span> -r rstudio-server</span>
<span id="cb15-47"><a href="#cb15-47"></a><span class="fu">cp</span> /usr/local/lib/rstudio-server/extras/init.d/debian/rstudio-server /etc/init.d/rstudio-server</span>
<span id="cb15-48"><a href="#cb15-48"></a><span class="fu">chmod</span> +x /etc/init.d/rstudio-server </span>
<span id="cb15-49"><a href="#cb15-49"></a><span class="ex">update-rc.d</span> rstudio-server defaults</span>
<span id="cb15-50"><a href="#cb15-50"></a><span class="fu">ln</span> -f -s /usr/local/lib/rstudio-server/bin/rstudio-server /usr/sbin/rstudio-server</span>
<span id="cb15-51"><a href="#cb15-51"></a><span class="fu">chmod</span> 777 -R /usr/local/lib/R/site-library/</span>
<span id="cb15-52"><a href="#cb15-52"></a><span class="fu">mkdir</span> -p /var/run/rstudio-server</span>
<span id="cb15-53"><a href="#cb15-53"></a><span class="fu">mkdir</span> -p /var/lock/rstudio-server</span>
<span id="cb15-54"><a href="#cb15-54"></a><span class="fu">mkdir</span> -p /var/log/rstudio-server</span>
<span id="cb15-55"><a href="#cb15-55"></a><span class="fu">mkdir</span> -p /var/lib/rstudio-server</span>
<span id="cb15-56"><a href="#cb15-56"></a><span class="fu">rm</span> -rf /home/pi/rstudio</span>
<span id="cb15-57"><a href="#cb15-57"></a><span class="fu">nano</span> /etc/init.d/rstudio-server</span>
<span id="cb15-58"><a href="#cb15-58"></a>    <span class="co"># Modify your PATH variable for using the compiled version of R</span></span>
<span id="cb15-59"><a href="#cb15-59"></a>        <span class="co"># PATH=/usr/local/bin/:/sbin:/usr/sbin:/bin:/usr/bin</span></span>
<span id="cb15-60"><a href="#cb15-60"></a><span class="ex">systemctl</span> daemon-reload</span>
<span id="cb15-61"><a href="#cb15-61"></a><span class="ex">rstudio-server</span> start</span>
<span id="cb15-62"><a href="#cb15-62"></a><span class="bu">exit</span></span></code></pre></div>
</div>
<div id="extra-steps" class="section level2">
<h2>Extra Steps</h2>
<p>Make pretty URLs for Shiny and Rstudio Server (e.g. <code>http://your-ip/shiny/your-app</code> instead of <code>http://your-ip:3838/your-app</code>) by editing Nginx config file: <code>sudo nano /etc/nginx/sites-enabled/default</code> and adding the following lines before the line that reads <code>server {</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a><span class="ex">map</span> <span class="va">$http_upgrade</span> <span class="va">$connection_upgrade</span> {</span>
<span id="cb16-2"><a href="#cb16-2"></a>      <span class="ex">default</span> upgrade<span class="kw">;</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>      <span class="st">&#39;&#39;</span>      <span class="ex">close</span><span class="kw">;</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>    }</span></code></pre></div>
<p>Add the following lines right after the line that reads <code>server_name _;</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a>    <span class="ex">rewrite</span> ^/shiny$ <span class="va">$scheme</span>://<span class="va">$http_host</span>/shiny/ permanent<span class="kw">;</span></span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="ex">location</span> /shiny/ {</span>
<span id="cb17-4"><a href="#cb17-4"></a>            <span class="ex">rewrite</span> ^/shiny/(.*)$ <span class="ex">/</span><span class="va">$1</span> <span class="bu">break</span><span class="kw">;</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>            <span class="ex">proxy_pass</span> http://localhost:3838<span class="kw">;</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>            <span class="ex">proxy_redirect</span> / <span class="va">$scheme</span>://<span class="va">$http_host</span>/shiny/<span class="kw">;</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>            <span class="ex">proxy_http_version</span> 1.1<span class="kw">;</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>            <span class="ex">proxy_set_header</span> Upgrade <span class="va">$http_upgrade</span><span class="kw">;</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>            <span class="ex">proxy_set_header</span> Connection <span class="va">$connection_upgrade</span><span class="kw">;</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>            <span class="ex">proxy_read_timeout</span> 20d<span class="kw">;</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>            <span class="ex">proxy_buffering</span> off<span class="kw">;</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>    }</span>
<span id="cb17-13"><a href="#cb17-13"></a>    </span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="ex">rewrite</span> ^/rstudio$ <span class="va">$scheme</span>://<span class="va">$http_host</span>/rstudio/ permanent<span class="kw">;</span> </span>
<span id="cb17-15"><a href="#cb17-15"></a>    </span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="ex">location</span> /rstudio/ {</span>
<span id="cb17-17"><a href="#cb17-17"></a>        <span class="ex">rewrite</span> ^/rstudio/(.*)$ <span class="ex">/</span><span class="va">$1</span> <span class="bu">break</span><span class="kw">;</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>        <span class="ex">proxy_pass</span> http://localhost:8787<span class="kw">;</span></span>
<span id="cb17-19"><a href="#cb17-19"></a>        <span class="ex">proxy_redirect</span> http://localhost:8787/ <span class="va">$scheme</span>://<span class="va">$http_host</span>/rstudio/<span class="kw">;</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>        <span class="ex">proxy_http_version</span> 1.1<span class="kw">;</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>        <span class="ex">proxy_set_header</span> Upgrade <span class="va">$http_upgrade</span><span class="kw">;</span></span>
<span id="cb17-22"><a href="#cb17-22"></a>        <span class="ex">proxy_set_header</span> Connection <span class="va">$connection_upgrade</span><span class="kw">;</span></span>
<span id="cb17-23"><a href="#cb17-23"></a>        <span class="ex">proxy_read_timeout</span> 20d<span class="kw">;</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>    }</span></code></pre></div>
<p>Now you have to restart Nginx to apply changes:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">sudo</span> service nginx restart</span></code></pre></div>
<p>If you want to have access to your server from remote origins (over the internet) you must follow these extra steps:</p>
<ul>
<li>If you don’t have a static public IP:
<ul>
<li>Open an account in a Dynamic DNS Services e.g. <a href="https://www.noip.com" class="uri">https://www.noip.com</a></li>
<li>Configure Dynamic DNS in your router/modem, if you don’t have that option, you can install a DDNS client on your server.</li>
<li>Optionally configure your personal domain name to point to your DDNS service</li>
</ul></li>
<li>Configure port forwarding in your router/modem:
<ul>
<li>For SSH open port TCP/UDP 22~22</li>
<li>For PostgreSQL open port TCP/UDP 5432</li>
<li>For FTP open port TCP 20~21</li>
<li>For VPN open port UDP 1194</li>
<li>For HTTP open port TCP 80</li>
</ul></li>
<li>Make sure you have “Block WAN traffic” disabled on your router/modem.</li>
</ul>
<p>And this is it, you are ready to start developing your Shiny apps and deploying it in the <code>/srv/shiny-server</code> folder of your own server, enjoy!</p>
</div>
<div id="final-comments" class="section level2">
<h2>Final Comments</h2>
<p>The major limitation of the Raspberry Pi is RAM memory, so keep in mind that you have to keep your apps simple enough so they don’t need more than 1 GB of RAM if your app requires something greater than that, it’s going to be using swap memory and that could ruin your SD card very fast.</p>
<p>The performance is relatively slow, especially for plotting, keep in mind that even though the Raspberry Pi 3B+ has 4 cores they are not fast ones and most of the R packages don’t use parallel computing.</p>
</div>
